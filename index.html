<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
    />
    <meta name="theme-color" content="#0e2a2f" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <link rel="manifest" href="manifest.json" />
    <script>
      (function () {
        const key = "racetimer-nocache";
        const params = new URLSearchParams(window.location.search);
        const token = params.get("nocache") || sessionStorage.getItem(key);
        if (token) sessionStorage.setItem(key, token);
        const href = token ? `style.css?nocache=${encodeURIComponent(token)}` : "style.css";
        const link = document.createElement("link");
        link.rel = "stylesheet";
        link.href = href;
        document.head.appendChild(link);
      })();
    </script>
    <noscript>
      <link rel="stylesheet" href="style.css" />
    </noscript>
    <title>RaceTools</title>
  </head>
  <body class="home-mode">
    <div id="app"></div>
    <script type="module">
      import { renderAppShell } from "./ui/app-shell.js";

      const root = document.getElementById("app");
      renderAppShell(root);

      const key = "racetimer-nocache";
      const params = new URLSearchParams(window.location.search);
      const token = params.get("nocache") || sessionStorage.getItem(key);
      if (token) sessionStorage.setItem(key, token);
      const src = token ? `./app.js?nocache=${encodeURIComponent(token)}` : "./app.js";
      import(src);
    </script>
  </body>
</html>
